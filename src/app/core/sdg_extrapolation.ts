import { range } from 'rxjs'

const RANDOM_CORRELATIONS = [
  [
    -Infinity,
    0.73716781,
    -0.98085788,
    -0.01144696,
    0.57257673,
    -0.90983805,
    0.71043322,
    0.68579243,
    0.17856733,
    -0.83611367,
    0.73696422,
    -0.94694144,
    -0.2886715,
    0.41325758,
    0.65724329,
    0.70449937,
    -0.52476757,
  ],
  [
    0.73716781,
    -Infinity,
    0.38604509,
    -0.78716036,
    0.83264208,
    0.16254651,
    -0.05334342,
    0.4160746,
    0.38402329,
    0.26224418,
    -0.03203928,
    -0.34543427,
    -0.77214451,
    -0.20553076,
    -0.38329881,
    0.75618088,
    -0.49250578,
  ],
  [
    -0.98085788,
    0.38604509,
    -Infinity,
    -0.53023385,
    -0.8965012,
    -0.55082313,
    -0.88885907,
    -0.7517106,
    0.7992125,
    0.15849807,
    -0.23420145,
    0.16203543,
    -0.27401574,
    0.10134854,
    0.07365716,
    0.9590969,
    -0.83592073,
  ],
  [
    -0.01144696,
    -0.78716036,
    -0.53023385,
    -Infinity,
    0.86738632,
    -0.16114135,
    -0.04067712,
    -0.23759406,
    0.1600971,
    0.04105636,
    -0.45866643,
    0.74287481,
    0.997544,
    -0.22599662,
    -0.66257311,
    0.52783846,
    0.94615912,
  ],
  [
    0.57257673,
    0.83264208,
    -0.8965012,
    0.86738632,
    -Infinity,
    0.50690102,
    -0.26489322,
    -0.85035501,
    0.60158264,
    -0.03989042,
    0.46198381,
    0.74065478,
    -0.17030091,
    0.34481149,
    -0.41551192,
    0.3806587,
    0.62362595,
  ],
  [
    -0.90983805,
    0.16254651,
    -0.55082313,
    -0.16114135,
    0.50690102,
    -Infinity,
    -0.79454118,
    -0.14832965,
    -0.11907191,
    -0.63289425,
    0.08876858,
    0.8131548,
    -0.84629207,
    0.17645283,
    0.99437075,
    0.80085247,
    0.50335978,
  ],
  [
    0.71043322,
    -0.05334342,
    -0.88885907,
    -0.04067712,
    -0.26489322,
    -0.79454118,
    -Infinity,
    0.2257582,
    0.12668557,
    -0.95086729,
    -0.95683487,
    0.28357136,
    -0.26137836,
    -0.07429062,
    0.29046848,
    0.81111884,
    0.5055359,
  ],
  [
    0.68579243,
    0.4160746,
    -0.7517106,
    -0.23759406,
    -0.85035501,
    -0.14832965,
    0.2257582,
    -Infinity,
    -0.76846558,
    -0.05296864,
    0.10497826,
    -0.68372255,
    -0.5993337,
    -0.41765642,
    0.11996232,
    0.11316373,
    -0.25669745,
  ],
  [
    0.17856733,
    0.38402329,
    0.7992125,
    0.1600971,
    0.60158264,
    -0.11907191,
    0.12668557,
    -0.76846558,
    -Infinity,
    0.04616319,
    0.88793645,
    -0.07920412,
    -0.03847303,
    0.35397288,
    -0.78274999,
    0.84304455,
    -0.77273963,
  ],
  [
    -0.83611367,
    0.26224418,
    0.15849807,
    0.04105636,
    -0.03989042,
    -0.63289425,
    -0.95086729,
    -0.05296864,
    0.04616319,
    -Infinity,
    0.9020666,
    -0.64928915,
    -0.17746192,
    0.2121116,
    -0.35907481,
    0.10670143,
    -0.08433111,
  ],
  [
    0.73696422,
    -0.03203928,
    -0.23420145,
    -0.45866643,
    0.46198381,
    0.08876858,
    -0.95683487,
    0.10497826,
    0.88793645,
    0.9020666,
    -Infinity,
    0.56529323,
    -0.54113424,
    -0.10880558,
    -0.36637756,
    0.42669893,
    -0.14799312,
  ],
  [
    -0.94694144,
    -0.34543427,
    0.16203543,
    0.74287481,
    0.74065478,
    0.8131548,
    0.28357136,
    -0.68372255,
    -0.07920412,
    -0.64928915,
    0.56529323,
    -Infinity,
    -0.58089251,
    -0.54628024,
    -0.13792732,
    -0.05083143,
    -0.86003472,
  ],
  [
    -0.2886715,
    -0.77214451,
    -0.27401574,
    0.997544,
    -0.17030091,
    -0.84629207,
    -0.26137836,
    -0.5993337,
    -0.03847303,
    -0.17746192,
    -0.54113424,
    -0.58089251,
    -Infinity,
    0.29310323,
    -0.75341193,
    -0.45005865,
    0.35640526,
  ],
  [
    0.41325758,
    -0.20553076,
    0.10134854,
    -0.22599662,
    0.34481149,
    0.17645283,
    -0.07429062,
    -0.41765642,
    0.35397288,
    0.2121116,
    -0.10880558,
    -0.54628024,
    0.29310323,
    -Infinity,
    -0.77878952,
    -0.01236657,
    -0.57392396,
  ],
  [
    0.65724329,
    -0.38329881,
    0.07365716,
    -0.66257311,
    -0.41551192,
    0.99437075,
    0.29046848,
    0.11996232,
    -0.78274999,
    -0.35907481,
    -0.36637756,
    -0.13792732,
    -0.75341193,
    -0.77878952,
    -Infinity,
    -0.95948628,
    -0.37132332,
  ],
  [
    0.70449937,
    0.75618088,
    0.9590969,
    0.52783846,
    0.3806587,
    0.80085247,
    0.81111884,
    0.11316373,
    0.84304455,
    0.10670143,
    0.42669893,
    -0.05083143,
    -0.45005865,
    -0.01236657,
    -0.95948628,
    -Infinity,
    -0.82567568,
  ],
  [
    -0.52476757,
    -0.49250578,
    -0.83592073,
    0.94615912,
    0.62362595,
    0.50335978,
    0.5055359,
    -0.25669745,
    -0.77273963,
    -0.08433111,
    -0.14799312,
    -0.86003472,
    0.35640526,
    -0.57392396,
    -0.37132332,
    -0.82567568,
    -Infinity,
  ],
]

// source: https://doi.org/10.1007/s11135-022-01443-4 Table 4: Correlation matrix of publications of India on 16 SDGs
const SDG_GAINS_CORRELATIONS = [
  [
    -Infinity,
    -0.08,
    -0.19,
    0.79,
    0.86,
    -0.29,
    -0.34,
    0.35,
    0.01,
    0.77,
    -0.57,
    -0.36,
    -0.31,
    -0.46,
    -0.32,
    0.53,
    0,
  ],
  [
    -0.08,
    -Infinity,
    0.64,
    -0.16,
    -0.2,
    0.83,
    0.65,
    -0.13,
    0.12,
    -0.12,
    0.46,
    0.72,
    0.87,
    0.73,
    0.86,
    -0.05,
    0,
  ],
  [
    -0.19,
    0.64,
    -Infinity,
    -0.1,
    0.08,
    0.64,
    0.54,
    -0.2,
    0.17,
    0.05,
    0.43,
    0.66,
    0.52,
    0.53,
    0.57,
    0.41,
    0,
  ],
  [
    0.79,
    -0.16,
    -0.1,
    -Infinity,
    0.8,
    -0.33,
    -0.31,
    0.12,
    -0.05,
    0.7,
    -0.56,
    -0.28,
    -0.42,
    -0.47,
    -0.43,
    0.57,
    0,
  ],
  [
    0.86,
    -0.2,
    0.08,
    0.8,
    -Infinity,
    -0.33,
    -0.39,
    0.22,
    -0.01,
    0.79,
    -0.56,
    -0.33,
    -0.49,
    -0.51,
    -0.44,
    0.73,
    0,
  ],
  [
    -0.29,
    0.83,
    0.64,
    -0.33,
    -0.33,
    -Infinity,
    0.72,
    -0.18,
    0.29,
    -0.26,
    0.64,
    0.75,
    0.86,
    0.73,
    0.89,
    -0.08,
    0,
  ],
  [
    -0.34,
    0.65,
    0.54,
    -0.31,
    -0.39,
    0.72,
    -Infinity,
    0.29,
    0.67,
    -0.1,
    0.81,
    0.92,
    0.74,
    0.67,
    0.64,
    0.11,
    0,
  ],
  [
    0.35,
    -0.13,
    -0.2,
    0.12,
    0.22,
    -0.18,
    0.29,
    -Infinity,
    0.7,
    0.48,
    0.22,
    0.22,
    -0.17,
    -0.31,
    -0.31,
    0.39,
    0,
  ],
  [
    0.01,
    0.12,
    0.17,
    -0.05,
    -0.01,
    0.29,
    0.67,
    0.7,
    -Infinity,
    0.32,
    0.66,
    0.61,
    0.21,
    0.14,
    0.14,
    0.41,
    0,
  ],
  [
    0.77,
    -0.12,
    0.05,
    0.7,
    0.79,
    -0.26,
    -0.1,
    0.48,
    0.32,
    -Infinity,
    -0.31,
    -0.09,
    -0.28,
    -0.33,
    -0.38,
    0.85,
    0,
  ],
  [
    -0.57,
    0.46,
    0.43,
    -0.56,
    -0.56,
    0.64,
    0.81,
    0.22,
    0.66,
    -0.31,
    -Infinity,
    0.82,
    0.63,
    0.48,
    0.62,
    -0.06,
    0,
  ],
  [
    -0.36,
    0.72,
    0.66,
    -0.28,
    -0.33,
    0.75,
    0.92,
    0.22,
    0.61,
    -0.09,
    0.82,
    -Infinity,
    0.71,
    0.66,
    0.68,
    0.12,
    0,
  ],
  [
    -0.31,
    0.87,
    0.52,
    -0.42,
    -0.49,
    0.86,
    0.74,
    -0.17,
    0.21,
    -0.28,
    0.63,
    0.71,
    -Infinity,
    0.86,
    0.95,
    -0.16,
    0,
  ],
  [
    -0.46,
    0.73,
    0.53,
    -0.47,
    -0.51,
    0.73,
    0.67,
    -0.31,
    0.14,
    -0.33,
    0.48,
    0.66,
    0.86,
    -Infinity,
    0.83,
    -0.17,
    0,
  ],
  [
    -0.32,
    0.86,
    0.57,
    -0.43,
    -0.44,
    0.89,
    0.64,
    -0.31,
    0.14,
    -0.38,
    0.62,
    0.68,
    0.95,
    0.83,
    -Infinity,
    -0.22,
    0,
  ],
  [
    0.53,
    -0.05,
    0.41,
    0.57,
    0.73,
    -0.08,
    0.11,
    0.39,
    0.41,
    0.85,
    -0.06,
    0.12,
    -0.16,
    -0.17,
    -0.22,
    -Infinity,
    0,
  ],
  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -Infinity],
]

export function extrapolateSDGs(
  correlations: number[][],
  originalSDGs: Set<number>
): Set<number> {
  var results = new Set<number>()
  if (originalSDGs.size == 0) {
    return results
  }

  var SDGs: number[] = Array.from(originalSDGs)

  var correlationValues: number[] = Object.assign(
    [],
    correlations[(SDGs.shift() ?? 0) - 1]
  )

  for (var SDG of SDGs) {
    correlations[SDG - 1].forEach(
      (value, index) => (correlationValues[index] += value)
    )
  }

  for (var _ of [0, 1, 2]) {
    let SDG: number =
      correlationValues.indexOf(Math.max(...correlationValues)) + 1
    results.add(SDG)
    correlationValues[SDG - 1] = -Infinity
  }
  return results
}

export function extrapolateSDGGains(originalSDGs: Set<number>): Set<number> {
  return extrapolateSDGs(SDG_GAINS_CORRELATIONS, originalSDGs)
}

export function extrapolateSDGHarms(originalSDGs: Set<number>): Set<number> {
  return extrapolateSDGs(RANDOM_CORRELATIONS, originalSDGs)
}
